<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>APIs · ClimaComms.jl</title><meta name="title" content="APIs · ClimaComms.jl"/><meta property="og:title" content="APIs · ClimaComms.jl"/><meta property="twitter:title" content="APIs · ClimaComms.jl"/><meta name="description" content="Documentation for ClimaComms.jl."/><meta property="og:description" content="Documentation for ClimaComms.jl."/><meta property="twitter:description" content="Documentation for ClimaComms.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaComms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../internals/">Developing with <code>ClimaComms</code></a></li><li><a class="tocitem" href="../logging/">Logging</a></li><li><a class="tocitem" href="../faqs/">Frequently Asked Questions</a></li><li class="is-active"><a class="tocitem" href>APIs</a><ul class="internal"><li><a class="tocitem" href="#Loading"><span>Loading</span></a></li><li><a class="tocitem" href="#Devices"><span>Devices</span></a></li><li><a class="tocitem" href="#Contexts"><span>Contexts</span></a></li><li><a class="tocitem" href="#Logging"><span>Logging</span></a></li><li><a class="tocitem" href="#Context-operations"><span>Context operations</span></a></li><li><a class="tocitem" href="#Collective-operations"><span>Collective operations</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>APIs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>APIs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaComms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaComms.jl/blob/main/docs/src/apis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="APIs"><a class="docs-heading-anchor" href="#APIs">APIs</a><a id="APIs-1"></a><a class="docs-heading-anchor-permalink" href="#APIs" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.ClimaComms" href="#ClimaComms.ClimaComms"><code>ClimaComms.ClimaComms</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">ClimaComms</code></pre><p>Abstracts the communications interface for the various CliMA components in order to:</p><ul><li>support different computational backends (CPUs, GPUs)</li><li>enable the use of different backends as transports (MPI, SharedArrays, etc.), and</li><li>transparently support single or double buffering for GPUs, depending on whether the transport has the ability to access GPU memory.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/ClimaComms.jl#L1-L11">source</a></section></article><h2 id="Loading"><a class="docs-heading-anchor" href="#Loading">Loading</a><a id="Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Loading" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@import_required_backends" href="#ClimaComms.@import_required_backends"><code>ClimaComms.@import_required_backends</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">ClimaComms.@import_required_backends</code></pre><p>If the desired context is MPI (as determined by <code>ClimaComms.context()</code>), try loading MPI.jl. If the desired device is CUDA (as determined by <code>ClimaComms.device()</code>), try loading CUDA.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/loading.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.cuda_is_required" href="#ClimaComms.cuda_is_required"><code>ClimaComms.cuda_is_required</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cuda_is_required()</code></pre><p>Returns a Bool indicating if CUDA should be loaded, based on the <code>ENV[&quot;CLIMACOMMS_DEVICE&quot;]</code>. See <a href="#ClimaComms.device"><code>ClimaComms.device</code></a> for more information.</p><pre><code class="language-julia hljs">cuda_is_required() &amp;&amp; using CUDA</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/loading.jl#L18-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.mpi_is_required" href="#ClimaComms.mpi_is_required"><code>ClimaComms.mpi_is_required</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mpi_is_required()</code></pre><p>Returns a Bool indicating if MPI should be loaded, based on the <code>ENV[&quot;CLIMACOMMS_CONTEXT&quot;]</code>. See <a href="#ClimaComms.context"><code>ClimaComms.context</code></a> for more information.</p><pre><code class="language-julia hljs">mpi_is_required() &amp;&amp; using MPI</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/loading.jl#L5-L15">source</a></section></article><h2 id="Devices"><a class="docs-heading-anchor" href="#Devices">Devices</a><a id="Devices-1"></a><a class="docs-heading-anchor-permalink" href="#Devices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.AbstractDevice" href="#ClimaComms.AbstractDevice"><code>ClimaComms.AbstractDevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractDevice</code></pre><p>The base type for a device.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.AbstractCPUDevice" href="#ClimaComms.AbstractCPUDevice"><code>ClimaComms.AbstractCPUDevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractCPUDevice()</code></pre><p>Abstract device type for single-threaded and multi-threaded CPU runs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.CPUSingleThreaded" href="#ClimaComms.CPUSingleThreaded"><code>ClimaComms.CPUSingleThreaded</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CPUSingleThreaded()</code></pre><p>Use the CPU with single thread.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.CPUMultiThreaded" href="#ClimaComms.CPUMultiThreaded"><code>ClimaComms.CPUMultiThreaded</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CPUMultiThreaded()</code></pre><p>Use the CPU with multiple thread.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.CUDADevice" href="#ClimaComms.CUDADevice"><code>ClimaComms.CUDADevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CUDADevice()</code></pre><p>Use NVIDIA GPU accelarator</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.device" href="#ClimaComms.device"><code>ClimaComms.device</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ClimaComms.device()</code></pre><p>Determine the device to use depending on the <code>CLIMACOMMS_DEVICE</code> environment variable.</p><p>Allowed values:</p><ul><li><code>CPU</code>, single-threaded or multi-threaded depending on the number of threads;</li><li><code>CPUSingleThreaded</code>,</li><li><code>CPUMultiThreaded</code>,</li><li><code>CUDA</code>.</li></ul><p>The default is <code>CPU</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L65-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.device_functional" href="#ClimaComms.device_functional"><code>ClimaComms.device_functional</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ClimaComms.device_functional(device)</code></pre><p>Return true when the <code>device</code> is correctly set up.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.array_type" href="#ClimaComms.array_type"><code>ClimaComms.array_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ClimaComms.array_type(::AbstractDevice)</code></pre><p>The base array type used by the specified device (currently <code>Array</code> or <code>CuArray</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.allowscalar" href="#ClimaComms.allowscalar"><code>ClimaComms.allowscalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allowscalar(f, ::AbstractDevice, args...; kwargs...)</code></pre><p>Device-flexible version of <code>CUDA.@allowscalar</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">f(args...)</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@allowscalar f(args...)</code></pre><p>for CUDA devices.</p><p>This is usefully written with closures via</p><pre><code class="language-julia hljs">allowscalar(device) do
    f()
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L206-L227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@time" href="#ClimaComms.@time"><code>ClimaComms.@time</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@time device expr</code></pre><p>Device-flexible <code>@time</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">@time expr</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@time expr</code></pre><p>for CUDA devices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L230-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@elapsed" href="#ClimaComms.@elapsed"><code>ClimaComms.@elapsed</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@elapsed device expr</code></pre><p>Device-flexible <code>@elapsed</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">@elapsed expr</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@elapsed expr</code></pre><p>for CUDA devices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L309-L323">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@assert" href="#ClimaComms.@assert"><code>ClimaComms.@assert</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@assert device cond [text]</code></pre><p>Device-flexible <code>@assert</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">@assert cond [text]</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@cuassert cond [text]</code></pre><p>for CUDA devices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L329-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@sync" href="#ClimaComms.@sync"><code>ClimaComms.@sync</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@sync device expr</code></pre><p>Device-flexible <code>@sync</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">@sync expr</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@sync expr</code></pre><p>for CUDA devices.</p><p>An example use-case of this might be:</p><pre><code class="language-julia hljs">BenchmarkTools.@benchmark begin
    if ClimaComms.device() isa ClimaComms.CUDADevice
        CUDA.@sync begin
            launch_cuda_kernels_or_spawn_tasks!(...)
        end
    elseif ClimaComms.device() isa ClimaComms.CPUMultiThreading
        Base.@sync begin
            launch_cuda_kernels_or_spawn_tasks!(...)
        end
    end
end</code></pre><p>If the CPU version of the above example does not leverage spawned tasks (which require using <code>Base.sync</code> or <code>Threads.wait</code> to synchronize), then you may want to simply use <a href="#ClimaComms.@cuda_sync"><code>@cuda_sync</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L250-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@cuda_sync" href="#ClimaComms.@cuda_sync"><code>ClimaComms.@cuda_sync</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@cuda_sync device expr</code></pre><p>Device-flexible <code>CUDA.@sync</code>.</p><p>Lowers to</p><pre><code class="language-julia hljs">expr</code></pre><p>for CPU devices and</p><pre><code class="language-julia hljs">CUDA.@sync expr</code></pre><p>for CUDA devices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L289-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Adapt.adapt_structure-Tuple{Type{&lt;:AbstractArray}, ClimaComms.AbstractDevice}" href="#Adapt.adapt_structure-Tuple{Type{&lt;:AbstractArray}, ClimaComms.AbstractDevice}"><code>Adapt.adapt_structure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Adapt.adapt_structure(::Type{&lt;:AbstractArray}, device::AbstractDevice)</code></pre><p>Adapt a given device to a device associated with the given array type.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">Adapt.adapt_structure(Array, ClimaComms.CUDADevice()) -&gt; ClimaComms.CPUSingleThreaded()</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>By default, adapting to <code>Array</code> creates a <code>CPUSingleThreaded</code> device, and there is currently no way to conver to a CPUMultiThreaded device.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/adapt.jl#L21-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.@threaded" href="#ClimaComms.@threaded"><code>ClimaComms.@threaded</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@threaded [device] [coarsen=...] [block_size=...] for ... end</code></pre><p>Device-flexible generalization of <code>Threads.@threads</code>, which distributes the iterations of a for-loop across multiple threads, with the option to control thread coarsening and GPU kernel configuration. Coarsening makes each thread evaluate more than one iteration of the loop, which can improve performance by reducing the runtime overhead of launching additional threads (though too much coarsening worsens performance because it reduces parallelization). The <code>device</code> is either inferred by calling <code>ClimaComms.device()</code>, or it can be specified manually, with the following device-dependent behavior:</p><ul><li><p>When <code>device</code> is a <code>CPUSingleThreaded()</code>, the loop is evaluated as-is. This avoids the runtime overhead of calling <code>Threads.@threads</code> with a single thread, and, when the device type is statically inferrable, it also avoids compilation overhead.</p></li><li><p>When <code>device</code> is a <code>CPUMultiThreaded()</code>, the loop is passed to <code>Threads.@threads</code>. This supports three different kinds of &quot;schedulers&quot; for determining how many iterations of the loop to evaluate in each thread:</p><ol><li>(default) a &quot;dynamic&quot; scheduler that changes the number of iterations as new threads are launched,</li><li>a &quot;static&quot; scheduler that evaluates a fixed number of iterations per thread, and</li><li>a &quot;greedy&quot; scheduler that uses a small number of threads, continuously evaluating iterations in each thread until the loop is completed (only available as of Julia 1.11).</li></ol><p>Setting <code>coarsen</code> to <code>:dynamic</code> or <code>:greedy</code> launches threads with those schedulers. Setting it to <code>:static</code> or an integer value launches threads with static scheduling (using <code>:static</code> is similar to using <code>1</code>, but slightly more performant). To read more about multi-threading, see the documentation for <a href="https://docs.julialang.org/en/v1/base/multi-threading/#Base.Threads.@threads"><code>Threads.@threads</code></a>.</p></li><li><p>When <code>device</code> is a <code>CUDADevice()</code>, the loop is compiled with <code>CUDA.@cuda</code> and run with <code>CUDA.@sync</code>. Since CUDA launches all threads at the same time, only static scheduling can be used. Setting <code>coarsen</code> to any symbol causes each thread to evaluate a single iteration (default), and setting it to an integer value causes each thread to evaluate that number of iterations (the default is similar to using <code>1</code>, but slightly more performant). If the total number of iterations in the loop is extremely large, the specified coarsening may require more threads than can be simultaneously launched on the GPU, in which case the amount of coarsening is automatically increased.</p><p>The optional argument <code>block_size</code> is also available for manually specifying the size of each block on a GPU. The default value of <code>:auto</code> sets the number of threads in each block to the largest possible value that permits a high GPU &quot;occupancy&quot; (the number of active thread warps in each multiprocessor executing the kernel). An integer can be used instead of <code>:auto</code> to override this default value. If the specified value exceeds the total number of threads, it is automatically decreased to avoid idle threads.</p></li></ul><p>Any iterator with methods for <code>firstindex</code>, <code>length</code>, and <code>getindex</code> can be used in a <code>@threaded</code> loop. All lazy iterators from <code>Base</code> and <code>Base.Iterators</code>, such as <code>zip</code>, <code>enumerate</code>, <code>Iterators.product</code>, and generator expressions, are also compatible with <code>@threaded</code>. (Although these iterators do not define methods for <code>getindex</code>, they are automatically modified by <code>threadable</code> to support <code>getindex</code>.) Using multiple iterators with <code>@threaded</code> is equivalent to looping over a single <code>Iterators.product</code>, with the innermost iterator of the loop appearing first in the product, and the outermost iterator appearing last.</p><p>NOTE: When a value in the body of the loop has a type that cannot be inferred by the compiler, an <code>InvalidIRError</code> will be thrown during compilation for a <code>CUDADevice()</code>. In particular, global variables are not inferrable, so <code>@threaded</code> must be wrapped in a function whenever it is used in the REPL:</p><pre><code class="language-julia-repl hljs">julia&gt; a = CUDA.CuArray{Int}(undef, 100); b = similar(a);

julia&gt; threaded_copyto!(a, b) = ClimaComms.@threaded for i in axes(a, 1)
           a[i] = b[i]
       end
threaded_copyto! (generic function with 1 method)

julia&gt; threaded_copyto!(a, b)

julia&gt; ClimaComms.@threaded for i in axes(a, 1)
           a[i] = b[i]
       end
ERROR: InvalidIRError: ...</code></pre><p>Moreover, type variables are not inferrable across function boundaries, so types used in a threaded loop cannot be precomputed before the loop:</p><pre><code class="language-julia-repl hljs">julia&gt; threaded_add_epsilon!(a) = ClimaComms.@threaded for i in axes(a, 1)
           FT = eltype(a)
           a[i] += eps(FT)
       end
threaded_add_epsilon! (generic function with 1 method)

julia&gt; threaded_add_epsilon!(a)

julia&gt; function threaded_add_epsilon!(a)
           FT = eltype(a)
           ClimaComms.@threaded for i in axes(a, 1)
               a[i] += eps(FT)
           end
       end
threaded_add_epsilon! (generic function with 1 method)

julia&gt; threaded_add_epsilon!(a)
ERROR: InvalidIRError: ...</code></pre><p>To fix other kinds of inference issues on GPUs, especially ones brought about by indexing into iterators with nonuniform element types, see <a href="https://github.com/CliMA/UnrolledUtilities.jl"><code>UnrolledUtilities.jl</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L352-L460">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.threaded" href="#ClimaComms.threaded"><code>ClimaComms.threaded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">threaded(f, device, itrs...; kwargs...)</code></pre><p>Functional form of <code>@threaded</code>. If there are <code>n</code> iterators and <code>f</code> is a function of <code>n</code> arguments, the <code>threaded</code> function is similar to</p><pre><code class="language-julia hljs">@threaded device [kwargs...] for xₙ in itrs[n], ..., x₂ in itrs[2], x₁ in itrs[1]
    f(x₁, x₂, ..., xₙ)
end</code></pre><p>On single-threaded CPU devices, the <code>@threaded</code> macro inlines the for-loop without any intermediate function calls, so that it has a lower latency than the <code>threaded</code> function. On other devices, the only difference between the macro and the function is that keyword argument symbols like <code>:dynamic</code> and <code>:auto</code> must be wrapped in <code>Val</code>s for the function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L522-L539">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.threadable" href="#ClimaComms.threadable"><code>ClimaComms.threadable</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">threadable(device, itr)</code></pre><p>Modifies an iterator to ensure that it can be used in a <code>@threaded</code> loop. This will typically return <code>itr</code> or a <code>ThreadableWrapper</code> of <code>itr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L594-L599">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.ThreadableWrapper" href="#ClimaComms.ThreadableWrapper"><code>ClimaComms.ThreadableWrapper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ThreadableWrapper</code></pre><p>Wrapper for an iterator from <code>Base</code> or <code>Iterators</code> that can be used in <code>@threaded</code>, with methods for <code>firstindex</code>, <code>length</code>, and <code>getindex</code>. The <code>getindex</code> method only supports linear indices between <code>firstindex</code> and <code>firstindex + length - 1</code>. For the <code>ThreadableWrapper</code> of <code>Iterators.product</code>, <code>getindex</code> converts each linear index to a Cartesian index using regular integer division on CPUs and <code>Base.multiplicativeinverse</code> on GPUs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/devices.jl#L602-L611">source</a></section></article><h2 id="Contexts"><a class="docs-heading-anchor" href="#Contexts">Contexts</a><a id="Contexts-1"></a><a class="docs-heading-anchor-permalink" href="#Contexts" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.AbstractCommsContext" href="#ClimaComms.AbstractCommsContext"><code>ClimaComms.AbstractCommsContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractCommsContext</code></pre><p>The base type for a communications context. Each backend defines a concrete subtype of this.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.SingletonCommsContext" href="#ClimaComms.SingletonCommsContext"><code>ClimaComms.SingletonCommsContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SingletonCommsContext(device=device())</code></pre><p>A singleton communications context, used for single-process runs. <a href="#ClimaComms.AbstractCPUDevice"><code>ClimaComms.AbstractCPUDevice</code></a> and <a href="#ClimaComms.CUDADevice"><code>ClimaComms.CUDADevice</code></a> device options are currently supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/singleton.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.MPICommsContext" href="#ClimaComms.MPICommsContext"><code>ClimaComms.MPICommsContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MPICommsContext()
MPICommsContext(device)
MPICommsContext(device, comm)</code></pre><p>A MPI communications context, used for distributed runs. <a href="#ClimaComms.AbstractCPUDevice"><code>AbstractCPUDevice</code></a> and <a href="#ClimaComms.CUDADevice"><code>CUDADevice</code></a> device options are currently supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/mpi.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.AbstractGraphContext" href="#ClimaComms.AbstractGraphContext"><code>ClimaComms.AbstractGraphContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractGraphContext</code></pre><p>A context for communicating between processes in a graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L156-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.context" href="#ClimaComms.context"><code>ClimaComms.context</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ClimaComms.context(device=device())</code></pre><p>Construct a default communication context.</p><p>By default, it will try to determine if it is running inside an MPI environment variables are set; if so it will return a <a href="#ClimaComms.MPICommsContext"><code>MPICommsContext</code></a>; otherwise it will return a <a href="#ClimaComms.SingletonCommsContext"><code>SingletonCommsContext</code></a>.</p><p>Behavior can be overridden by setting the <code>CLIMACOMMS_CONTEXT</code> environment variable to either <code>MPI</code> or <code>SINGLETON</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L24-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.graph_context" href="#ClimaComms.graph_context"><code>ClimaComms.graph_context</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">graph_context(context::AbstractCommsContext,
              sendarray, sendlengths, sendpids,
              recvarray, recvlengths, recvpids)</code></pre><p>Construct a communication context for exchanging neighbor data via a graph.</p><p>Arguments:</p><ul><li><code>context</code>: the communication context on which to construct the graph context.</li><li><code>sendarray</code>: array containing data to send</li><li><code>sendlengths</code>: list of lengths of data to send to each process ID</li><li><code>sendpids</code>: list of processor IDs to send</li><li><code>recvarray</code>: array to receive data into</li><li><code>recvlengths</code>: list of lengths of data to receive from each process ID</li><li><code>recvpids</code>: list of processor IDs to receive from</li></ul><p>This should return an <code>AbstractGraphContext</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L163-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Adapt.adapt_structure-Tuple{Type{&lt;:AbstractArray}, ClimaComms.AbstractCommsContext}" href="#Adapt.adapt_structure-Tuple{Type{&lt;:AbstractArray}, ClimaComms.AbstractCommsContext}"><code>Adapt.adapt_structure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Adapt.adapt_structure(::Type{&lt;:AbstractArray}, context::AbstractCommsContext)</code></pre><p>Adapt a given context to a context with a device associated with the given array type.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">Adapt.adapt_structure(Array, ClimaComms.context(ClimaComms.CUDADevice())) -&gt; ClimaComms.CPUSingleThreaded()</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>By default, adapting to <code>Array</code> creates a <code>CPUSingleThreaded</code> device, and there is currently no way to conver to a CPUMultiThreaded device.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/adapt.jl#L3-L17">source</a></section></article><h2 id="Logging"><a class="docs-heading-anchor" href="#Logging">Logging</a><a id="Logging-1"></a><a class="docs-heading-anchor-permalink" href="#Logging" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.OnlyRootLogger" href="#ClimaComms.OnlyRootLogger"><code>ClimaComms.OnlyRootLogger</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">OnlyRootLogger()
OnlyRootLogger(ctx::AbstractCommsContext)</code></pre><p>Return a logger that silences non-root processes.</p><p>If no context is passed, obtain the default context via <a href="#ClimaComms.context"><code>context</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/logging.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.MPILogger" href="#ClimaComms.MPILogger"><code>ClimaComms.MPILogger</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MPILogger(context::AbstractCommsContext)
MPILogger(iostream, context)</code></pre><p>Add a rank prefix before log messages.</p><p>Outputs to <code>stdout</code> if no IOStream is given.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/logging.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.FileLogger" href="#ClimaComms.FileLogger"><code>ClimaComms.FileLogger</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FileLogger(context, log_dir; log_stdout = true, min_level = Logging.Info)</code></pre><p>Log MPI ranks to different files within the <code>log_dir</code>.</p><p>The minimum logging level is set using <code>min_level</code>. If <code>log_stdout = true</code>, root process logs will be sent to stdout as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/logging.jl#L44-L51">source</a></section></article><h2 id="Context-operations"><a class="docs-heading-anchor" href="#Context-operations">Context operations</a><a id="Context-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Context-operations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.init" href="#ClimaComms.init"><code>ClimaComms.init</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">(pid, nprocs) = init(ctx::AbstractCommsContext)</code></pre><p>Perform any necessary initialization for the specified backend. Return a tuple of the processor ID and the number of participating processors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L54-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.mypid" href="#ClimaComms.mypid"><code>ClimaComms.mypid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mypid(ctx::AbstractCommsContext)</code></pre><p>Return the processor ID.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L62-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.iamroot" href="#ClimaComms.iamroot"><code>ClimaComms.iamroot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">iamroot(ctx::AbstractCommsContext)</code></pre><p>Return <code>true</code> if the calling processor is the root processor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.nprocs" href="#ClimaComms.nprocs"><code>ClimaComms.nprocs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nprocs(ctx::AbstractCommsContext)</code></pre><p>Return the number of participating processors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.abort" href="#ClimaComms.abort"><code>ClimaComms.abort</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">abort(ctx::CC, status::Int) where {CC &lt;: AbstractCommsContext}</code></pre><p>Terminate the caller and all participating processors with the specified <code>status</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L147-L152">source</a></section></article><h2 id="Collective-operations"><a class="docs-heading-anchor" href="#Collective-operations">Collective operations</a><a id="Collective-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Collective-operations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.barrier" href="#ClimaComms.barrier"><code>ClimaComms.barrier</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">barrier(ctx::CC) where {CC &lt;: AbstractCommsContext}</code></pre><p>Perform a global synchronization across all participating processors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.reduce" href="#ClimaComms.reduce"><code>ClimaComms.reduce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reduce(ctx::CC, val, op) where {CC &lt;: AbstractCommsContext}</code></pre><p>Perform a reduction across all participating processors, using <code>op</code> as the reduction operator and <code>val</code> as this rank&#39;s reduction value. Return the result to the first processor only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L92-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.reduce!" href="#ClimaComms.reduce!"><code>ClimaComms.reduce!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reduce!(ctx::CC, sendbuf, recvbuf, op)
reduce!(ctx::CC, sendrecvbuf, op)</code></pre><p>Performs elementwise reduction using the operator <code>op</code> on the buffer <code>sendbuf</code>, storing the result in the <code>recvbuf</code> of the process. If only one <code>sendrecvbuf</code> buffer is provided, then the operation is performed in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L102-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.allreduce" href="#ClimaComms.allreduce"><code>ClimaComms.allreduce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allreduce(ctx::CC, sendbuf, op)</code></pre><p>Performs elementwise reduction using the operator <code>op</code> on the buffer <code>sendbuf</code>, allocating a new array for the result. <code>sendbuf</code> can also be a scalar, in which case <code>recvbuf</code> will be a value of the same type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L112-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.allreduce!" href="#ClimaComms.allreduce!"><code>ClimaComms.allreduce!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">allreduce!(ctx::CC, sendbuf, recvbuf, op)
allreduce!(ctx::CC, sendrecvbuf, op)</code></pre><p>Performs elementwise reduction using the operator <code>op</code> on the buffer <code>sendbuf</code>, storing the result in the <code>recvbuf</code> of all processes in the group. <code>Allreduce!</code> is equivalent to a <code>Reduce!</code> operation followed by a <code>Bcast!</code>, but can lead to better performance. If only one <code>sendrecvbuf</code> buffer is provided, then the operation is performed in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L120-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.bcast" href="#ClimaComms.bcast"><code>ClimaComms.bcast</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bcast(ctx::AbstractCommsContext, object)</code></pre><p>Broadcast <code>object</code> from the root process to all other processes. The value of <code>object</code> on non-root processes is ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L139-L144">source</a></section></article><h3 id="Graph-exchange"><a class="docs-heading-anchor" href="#Graph-exchange">Graph exchange</a><a id="Graph-exchange-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-exchange" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.start" href="#ClimaComms.start"><code>ClimaComms.start</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">start(ctx::AbstractGraphContext)</code></pre><p>Initiate graph data exchange.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L184-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.progress" href="#ClimaComms.progress"><code>ClimaComms.progress</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">progress(ctx::AbstractGraphContext)</code></pre><p>Drive communication. Call after <code>start</code> to ensure that communication proceeds asynchronously.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L191-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaComms.finish" href="#ClimaComms.finish"><code>ClimaComms.finish</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">finish(ctx::AbstractGraphContext)</code></pre><p>Complete the communications step begun by <code>start()</code>. After this returns, data received from all neighbors will be available in the stage areas of each neighbor&#39;s receive buffer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaComms.jl/blob/7a6d65853ebf834d0da79b8d91be35aa36bbdf63/src/context.jl#L199-L205">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../faqs/">« Frequently Asked Questions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Friday 6 June 2025 05:07">Friday 6 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
